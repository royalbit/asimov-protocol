# Forge Protocol Roadmap

metadata:
  current_version: "4.1.7"
  last_updated: "2025-11-29"
  philosophy: "Integrate with Claude Code. Focus on unique value."

# ═══════════════════════════════════════════════════════════════════════════════
# PROTOCOL GOALS - Everything must align with these
# ═══════════════════════════════════════════════════════════════════════════════
#
# 0. ETHICAL_AUTONOMY - Prevent harm from autonomous AI (TOP PRIORITY)
# 1. ANTI-HALLUCINATION - Ground AI in file-based truth (factual hallucination)
# 1.5 ANTI-SYCOPHANCY - Counteract RLHF-induced validation hallucination (ADR-015)
# 2. SELF-HEALING - Mid-session recovery via warmup.yaml re-read (ADR-013: NOT REPLACED)
# 3. SESSION CONTINUITY - Cross-session resume (NOW: use --continue/--resume)
# 4. AUTONOMOUS_DEVELOPMENT - SKYNET MODE that actually works
# 5. GREEN_CODING - Local validation over cloud AI
#
# NOTE: "Hallucination" has TWO forms (see ADR-015, AI_REALITY.md):
#   - Factual hallucination: AI generates false FACTS
#   - Validation hallucination: AI generates false AGREEMENT (sycophancy)
# Both are caused by RLHF training. Both harm users.
#
# Features that don't serve these goals don't belong here.
#
# CRITICAL: Self-healing requires COMMIT CADENCE (~15 min) - see ADR-006
#
# ═══════════════════════════════════════════════════════════════════════════════

# ═══════════════════════════════════════════════════════════════════════════════
# STRATEGIC PIVOT (ADR-009, corrected by ADR-013)
# ═══════════════════════════════════════════════════════════════════════════════
#
# Claude Code 2.0 (Nov 2025) has native CROSS-SESSION features (all MANUAL):
#   - /rewind checkpoints (MANUAL command, not automatic)
#   - --continue/--resume (MANUAL CLI start, cross-session only)
#   - CLAUDE.md memory hierarchy (can import warmup.yaml)
#   - Auto-compact at 95% capacity (confirms ADR-003)
#
# IMPORTANT (ADR-013): Native features do NOT replace mid-session self-healing.
# Mid-session recovery uses warmup.yaml re-read + commit cadence (~15 min).
#
# PIVOT: Integrate with Claude Code for cross-session.
#        Keep mid-session self-healing (warmup.yaml + commit cadence).
#        Focus on unique value: Ethics, Green, Sprint Autonomy, Self-Healing.
#
# ═══════════════════════════════════════════════════════════════════════════════

# ═══════════════════════════════════════════════════════════════════════════════
# CURRENT: v4.1.7 - CLAUDE CODE HOOKS SCHEMA FIX (ADR-018 Revision)
# ═══════════════════════════════════════════════════════════════════════════════
current:
  version: "4.1.7"
  status: released
  date: "2025-11-29"
  summary: "Claude Code Hooks Schema Fix - Correct Configuration"
  goal: AUTONOMOUS_DEVELOPMENT
  priority: CRITICAL

  rationale: |
    v4.1.6 used incorrect hooks schema (wrong file, wrong events).
    Hooks must be in .claude/settings.json, not .claude/hooks.json.
    PreCompact event (not PostCompact) for context injection.
    This fix enables TRUE autonomous operation.

  deliverables:
    implementation:
      - "[x] .claude/settings.json - Correct hook configuration location"
      - "[x] .claude/hooks/session-start.sh - Auto-initialize on session start"
      - "[x] .claude/hooks/pre-compact.sh - Inject rules before compaction"

    documentation:
      - "[x] ADR-018: Revised with correct schema"
      - "[x] CHANGELOG.md updated with migration steps"

  breaking_changes:
    - "File: .claude/settings.json (was .claude/hooks.json)"
    - "Event: PreCompact (was PostCompact)"
    - "Script: pre-compact.sh (was post-compact.sh)"

  vendor_exclusivity: |
    Claude Code is the ONLY AI with lifecycle hooks.
    Cursor, Copilot, Windsurf, Gemini have no equivalent.
    SKYNET MODE requires Claude Code.

# ═══════════════════════════════════════════════════════════════════════════════
# RELEASED VERSIONS
# ═══════════════════════════════════════════════════════════════════════════════
previous:
  - version: "4.1.6"
    status: released
    date: "2025-11-29"
    summary: "Claude Code Hooks Integration (ADR-018) - SCHEMA ERROR"
    highlights:
      - "Initial hooks implementation with incorrect schema"
      - "Used .claude/hooks.json (wrong - should be settings.json)"
      - "Used PostCompact event (wrong - should be PreCompact)"
      - "Superseded by v4.1.7"

  - version: "4.1.5"
    status: released
    date: "2025-11-29"
    summary: "Protocol Self-Healing (ADR-017)"
    highlights:
      - "Auto-regenerate missing protocol files during validation"
      - "--no-regenerate flag to skip auto-creation"
      - "Sprint reclassified as protocol (not optional data)"

  - version: "4.1.2"
    status: released
    date: "2025-11-29"
    summary: "Green Coding Protocol Separation (ADR-016)"
    highlights:
      - "green.yaml - Dedicated green coding protocol file"
      - "step_0b_green_validation in session initialization"
      - "Green coding parity with Ethics protocol"

  - version: "4.1.1"
    status: released
    date: "2025-11-29"
    summary: "Ethics Validation at Session Start"
    highlights:
      - "step_0_ethics_validation in session initialization"
      - "Halt session if ethics validation fails"
      - "Regenerate ethics.yaml if missing"

  - version: "4.1.0"
    status: released
    date: "2025-11-29"
    summary: "Hardcoded Ethics (ADR-011)"
    highlights:
      - "cli/src/ethics.rs with hardcoded CORE_PRINCIPLES"
      - "RED_FLAGS - 27+ patterns across 4 categories"
      - "--ethics-scan flag for red flag detection"
      - "18 new unit tests"

  - version: "4.0.2"
    status: released
    date: "2025-11-29"
    summary: "Anti-Sycophancy Protocol (ADR-015)"
    highlights:
      - "Anti-sycophancy directives in warmup.yaml"
      - "Banned phrases list"
      - "AI_REALITY.md Part 3: Sycophancy"

  - version: "4.0.0"
    status: released
    date: "2025-11-28"
    summary: "Claude Code Native Integration (BREAKING)"
    highlights:
      - "Strategic pivot to integrate with Claude Code 2.0"
      - "CLAUDE.md @import syntax"
      - "Deprecated cross-session features for native alternatives"

  - version: "3.2.0"
    status: released
    date: "2025-11-29"
    summary: "Anti-Hallucination Hardening"
    highlights:
      - "Ethics structure validation (human_veto REQUIRED)"
      - "Warmup structure validation"
      - "Modular .forge/ schema design"

  - version: "3.1.0"
    status: released
    date: "2025-11-29"
    summary: "Self-Healing Completeness (ADR-007)"
    highlights:
      - "Checkpoint JSON schema"
      - "File size limits"
      - "ADR-007 Accepted"

  - version: "3.0.0"
    status: released
    date: "2025-11-28"
    summary: "Humanist Mode - Ethics Protocol"
    highlights:
      - "ethics.yaml protocol file"
      - "human_veto command"
      - "ADR-008: Ethics Protocol"

  - version: "2.1.0"
    status: released
    date: "2025-11-27"
    summary: "Git Hook Protocol Refresh (ADR-006)"

  - version: "2.0.0"
    status: released
    date: "2025-11-27"
    summary: "Self-Healing Based on Real Data"

  - version: "1.4.0"
    status: released
    date: "2025-11-26"
    summary: "SKYNET MODE Setup"

# ═══════════════════════════════════════════════════════════════════════════════
# FUTURE MILESTONES
# ═══════════════════════════════════════════════════════════════════════════════
future:

  # ═══════════════════════════════════════════════════════════════════════════
  # PRIORITY ORDER: Matches core values (0-5)
  # ═══════════════════════════════════════════════════════════════════════════
  # 0.  ETHICAL_AUTONOMY → v4.1.0 Hardcoded Ethics (RELEASED)
  # 0.5 GREEN_CODING → v4.1.2 Green Protocol Separation (RELEASED)
  # 1.  ANTI-HALLUCINATION → v4.1.5 Protocol Self-Healing (RELEASED - ADR-017)
  # 1.5 ANTI-SYCOPHANCY → v4.1.6 Anti-Sycophancy Protocol (CRITICAL - ADR-015)
  # 5.  GREEN_METRICS → v4.2.0 Hardcoded Green Coding Metrics (HIGH - ADR-012)
  # +   VENDOR_NEUTRALITY → v4.3.0 MCP Server Mode (enables adoption)
  # ═══════════════════════════════════════════════════════════════════════════

  # ─────────────────────────────────────────────────────────────────────────────
  # v4.1.6: ANTI-SYCOPHANCY PROTOCOL (ADR-015) - PRIORITY 1.5
  # ─────────────────────────────────────────────────────────────────────────────
  - version: "4.1.6"
    status: planned
    summary: "Anti-Sycophancy Protocol - Truth Over Comfort"
    goal: ANTI-SYCOPHANCY
    priority: CRITICAL
    core_value: 1.5
    adr: "docs/adr/015-anti-sycophancy-protocol.md"
    description: |
      Counteract RLHF-induced sycophancy (validation hallucination).
      AI models are 50% more sycophantic than humans (Nature 2025).
      This harms users: bad decisions, reinforced delusions, false confidence.
      Solution: Anti-sycophancy directives in warmup.yaml + CLI detection.
    rationale: |
      Sycophancy is the OTHER hallucination:
      - Factual hallucination: AI generates false FACTS
      - Validation hallucination: AI generates false AGREEMENT
      Both caused by RLHF. Both harm users. Both need protocol solutions.
    features:
      - "anti_sycophancy schema in warmup.yaml"
      - "Banned phrases list (You're absolutely right, etc.)"
      - "Required behaviors (problems FIRST, then merits)"
      - "--anti-sycophancy-check CLI command"
      - "Sycophancy detection in protocol refresh"
    references:
      - "https://www.nature.com/articles/d41586-025-03390-0"
      - "https://arxiv.org/abs/2510.01395"
      - "https://techcrunch.com/2025/08/25/ai-sycophancy-isnt-just-a-quirk-experts-consider-it-a-dark-pattern-to-turn-users-into-profit/"

  # ─────────────────────────────────────────────────────────────────────────────
  # v4.2.0: HARDCODED GREEN CODING (ADR-012) - PRIORITY 5
  # ─────────────────────────────────────────────────────────────────────────────
  - version: "4.2.0"
    status: planned
    summary: "Hardcoded Green Coding - Sustainability as Protocol Core"
    goal: GREEN_CODING
    priority: HIGH
    core_value: 5
    adr: "docs/adr/012-hardcoded-green-coding.md"
    description: |
      Build green coding measurement into CLI binary.
      Green score in every validation. Carbon/cost savings tracked.
      Gamification through badges and cumulative metrics.
    features:
      - "Green score in validate output (0-100)"
      - "--green-audit for binary/container size checks"
      - "green-report command for session metrics"
      - "green-badge command for README badges"
      - "Cumulative project carbon/cost tracking"

  # ─────────────────────────────────────────────────────────────────────────────
  # v4.3.0: MCP SERVER MODE - VENDOR NEUTRALITY
  # ─────────────────────────────────────────────────────────────────────────────
  - version: "4.3.0"
    status: planned
    summary: "MCP Server Mode"
    goal: VENDOR_NEUTRALITY
    priority: HIGH
    description: |
      Forge Protocol as MCP server. Provides ethics/sprint context via MCP.
      Works with Claude, OpenAI, Google (all adopted MCP).
      TRUE vendor neutrality - not just file format.
      Enables wider adoption beyond Claude Code.
    features:
      - "MCP server implementation in Rust"
      - "Ethics context as MCP resource"
      - "Sprint boundaries as MCP resource"
      - "Green coding metrics as MCP resource"

  # ─────────────────────────────────────────────────────────────────────────────
  # v4.4.0: SCHEMA STANDARDIZATION - PRIORITY 1
  # ─────────────────────────────────────────────────────────────────────────────
  - version: "4.4.0"
    status: planned
    summary: "Schema Standardization"
    goal: ANTI-HALLUCINATION
    priority: MEDIUM
    core_value: 1
    description: |
      Formalize schemas for remaining protocol files.
      Focus on ethics.yaml and warmup.yaml validation.
    features:
      - "ethics.yaml full JSON schema"
      - "warmup.yaml v2 schema with structure validation"
      - "sprint.yaml schema"
      - "roadmap.yaml schema"

# ═══════════════════════════════════════════════════════════════════════════════
# DEPRECATED vs ACTIVE (Clarified by ADR-013)
# ═══════════════════════════════════════════════════════════════════════════════
#
# CRITICAL DISTINCTION:
#
#   CROSS-SESSION features → Claude Code native (--continue, --resume)
#   MID-SESSION self-healing → STILL FORGE PROTOCOL (warmup.yaml re-read)
#
# Claude Code native features require MANUAL intervention:
#   - --continue/--resume = manual CLI start
#   - /rewind = manual command
#   - None work UNATTENDED during a live session before compaction
#
# SKYNET MODE mid-session self-healing is NOT replaced.
# See ADR-013 for the full analysis.
#
# ═══════════════════════════════════════════════════════════════════════════════

# What IS deprecated (cross-session, manual features)
deprecated:
  checkpoint_file:
    was: ".claude_checkpoint.yaml file"
    replaced_by: "TodoWrite for task tracking"
    reason: "Native checkpoints handle code state, TodoWrite handles task state"
    scope: "Task tracking only"

  session_handoff:
    was: "Custom session-end command and handoff files"
    replaced_by: "Claude Code --continue/--resume (manual CLI start)"
    reason: "Native session management for cross-session resume"
    scope: "Cross-session only (manual)"

# What is NOT deprecated (mid-session, automatic)
active:
  self_healing:
    feature: "warmup.yaml re-read on confusion"
    status: "ACTIVE - NOT REPLACED"
    reason: "Claude Code has NO automatic mid-session recovery before compaction"
    scope: "Mid-session, automatic, unattended"
    implementation: "self_healing.on_confusion in warmup.yaml"
    adr: "ADR-013"

  sprint_autonomy:
    feature: "4hr max, 1 milestone, quality gates"
    status: "ACTIVE - UNIQUE VALUE"
    reason: "Claude Code has no bounded session enforcement"

  ethics_protocol:
    feature: "ethics.yaml, human_veto, red flags"
    status: "ACTIVE - UNIQUE VALUE"
    reason: "Claude Code has no ethics framework"

  green_coding:
    feature: "Local-first validation, ESG metrics"
    status: "ACTIVE - UNIQUE VALUE"
    reason: "Claude Code has no green coding philosophy"

  anti_sycophancy:
    feature: "anti_sycophancy directives in warmup.yaml"
    status: "ACTIVE - UNIQUE VALUE"
    reason: "Claude Code has no anti-sycophancy enforcement"
    adr: "ADR-015"
    documentation:
      - "docs/AI_REALITY.md - Part 3: Sycophancy"
      - "docs/SPECIFICATION.md - anti_sycophancy schema"
      - "docs/adr/015-anti-sycophancy-protocol.md"

# ═══════════════════════════════════════════════════════════════════════════════
# BACKLOG - Nice to Have
# ═══════════════════════════════════════════════════════════════════════════════
backlog:
  - "CI Integration: GitHub Action for protocol validation"
  - "JSON Schema: Editor autocomplete for protocol files"
  - "VS Code Extension: Syntax highlighting, validation"
