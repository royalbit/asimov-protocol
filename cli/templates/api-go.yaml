# Enterprise Template: api-go
# Migrated from asimov-plus v2.1.0
# Go API with Gin, Clean Architecture, and GORM

identity:
  name: "{PROJECT_NAME}"
  type: backend-api
  tagline: "Go API with Clean Architecture"

stack:
  framework: "Gin + Clean Architecture + GORM"
  language: "Go 1.22+"
  database: "PostgreSQL"

quality:
  test: "go test ./..."
  lint: "golangci-lint run"
  build: "go build -o bin/api ./cmd/api"

structure:
  - cmd/api/main.go              # Entry point
  - internal/config/             # Configuration
  - internal/domain/             # Domain models
  - internal/repository/         # Data access layer
  - internal/service/            # Business logic
  - internal/handler/            # HTTP handlers
  - internal/router/             # Route definitions
  - internal/database/           # Database setup
  - internal/dto/                # Data transfer objects
  - Makefile                     # Build commands
  - Dockerfile
  - docker-compose.yml

features:
  - Gin web framework
  - GORM ORM with auto-migrate
  - Clean architecture layers
  - Interface-based dependencies
  - Testify for testing
  - Environment configuration
  - Health check endpoint
  - Docker support

# v10.8.0: Database migrations guidance (ADR-062)
migrations:
  principle: "Migration complete = functionally equivalent, not just compiles"
  tool: "GORM auto-migrate or golang-migrate"
  strategies:
    - test_parity: "Same tests pass before and after migration"
    - contract_testing: "Define input/output contracts, verify both satisfy"
    - behavioral_snapshots: "Capture old behavior as golden files"
    - shadow_mode: "Run both implementations, diff results"
  red_flags:
    - "Skipping tests for speed"
    - "Assuming compilation = correctness"
    - "Silent behavior changes"
