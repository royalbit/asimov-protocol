# Sprint Autonomy Protocol
# WHEN to stop - Bounded sessions for sustainable AI development

# ═══════════════════════════════════════════════════════════════════════════════
# CORE RULES (Non-negotiable)
# ═══════════════════════════════════════════════════════════════════════════════
rules:
  max_hours: 4
  max_milestones: 1
  must_ship: true
  mantra: "Done is better than perfect. Ship it."

# ═══════════════════════════════════════════════════════════════════════════════
# COMPLETED: v3.2.0 - ANTI-HALLUCINATION HARDENING
# ═══════════════════════════════════════════════════════════════════════════════
sprint:
  current: "v3.2.0 - Anti-Hallucination Hardening"
  started: "2025-11-29"
  status: done

  completed:
    - "[x] Ethics structure validation (human_veto + core_principles REQUIRED)"
    - "[x] Warmup structure validation (self_healing.on_confusion position check)"
    - "[x] Exported check_ethics_structure() and check_warmup_structure() APIs"
    - "[x] Unit tests for structure validation (8 new tests)"
    - "[x] SPECIFICATION.md: Structure Validation section"
    - "[x] SPECIFICATION.md: Modular .forge/ schema design"

  # ─────────────────────────────────────────────────────────────────────────────
  # CRITICAL PROBLEM STATEMENT
  # ─────────────────────────────────────────────────────────────────────────────
  # The current SPECIFICATION.md (v1.1.0) documents a MINIMAL protocol.
  # But forge-protocol's OWN warmup.yaml (676 lines) uses features that
  # aren't in the spec. We're not eating our own dog food.
  #
  # Worse: Self-healing is BROKEN. The "2hr checkpoint" is FICTION.
  # We documented what we HOPED would work, not what ACTUALLY works.
  #
  # Fix: Research Forge's real patterns first, then rewrite the spec.
  # ─────────────────────────────────────────────────────────────────────────────

  phase_1_research:
    status: pending
    description: "Study REAL compaction patterns before writing spec"
    tasks:
      - "[ ] Analyze Forge (royalbit/forge) for real compaction frequency"
      - "[ ] Document when /compact ACTUALLY triggers"
      - "[ ] Test what ACTUALLY survives compaction in CLAUDE.md"
      - "[ ] Identify why self-healing is broken"
      - "[ ] Study successful vs failed recovery patterns"

  phase_2_specification:
    status: blocked_by_research
    description: "Rewrite spec based on research findings"
    tasks:
      - "[ ] Document SKYNET MODE 5-component system"
      - "[ ] Document Bootstrap Chain (CLAUDE.md → warmup → checkpoint)"
      - "[ ] Fix Self-Healing based on REAL patterns"
      - "[ ] Add extended warmup.yaml schema sections"
      - "[ ] Design modular structure (bin/) to deflate warmup"
      - "[ ] Define checkpoint file format and ACTUAL triggers"

  phase_3_implementation:
    status: blocked_by_spec
    description: "Update CLI and templates to match new spec"
    tasks:
      - "[ ] Update --skynet to generate modular structure"
      - "[ ] Implement checkpoint file writing/reading"
      - "[ ] Update CLAUDE.md template for real self-healing"
      - "[ ] Add tests for new features"

  deliverables:
    - "SPECIFICATION.md v2.0"
    - "Working self-healing (actually recovers)"
    - "Modular warmup structure (bin/)"
    - "ADR-003: Self-Healing Based on Real Patterns"

  notes: |
    v2.0.0 - SPECIFICATION REWRITE

    Key insight from human: "the 2h checkpoint is NOT real, it's YOUR
    imagination, not based in reality... /compact happens more often
    than you think, and self-healing is broken even in forge"

    Action: Research first, spec second. No more fiction.

# ═══════════════════════════════════════════════════════════════════════════════
# PREVIOUS SPRINT (completed)
# ═══════════════════════════════════════════════════════════════════════════════
previous:
  sprint: "v3.1.0 - Self-Healing Completeness"
  status: done
  date: "2025-11-29"
  highlights:
    - "Checkpoint JSON schema for validation"
    - "File size limits: CLAUDE.md (10/15), checkpoint (20/30), warmup (200/500)"
    - "ADR-007 marked as Accepted"

# ═══════════════════════════════════════════════════════════════════════════════
# SESSION PHASES
# ═══════════════════════════════════════════════════════════════════════════════
phases:
  1_define:
    duration: "5-10 min"
    actions:
      - "State ONE milestone"
      - "Define 'done'"
      - "Set time budget (max 4h)"

  2_execute:
    duration: "2-4 hours"
    rules:
      - "NO scope creep ('Let me also...')"
      - "NO tangents ('While I'm here...')"
      - "NO gold plating ('This would be better if...')"
    checkpoint: "Every 2 hours - Am I still on track?"

  3_ship:
    duration: "15-30 min"
    checklist:
      - "cargo test (all pass)"
      - "cargo clippy (zero warnings)"
      - "Update CHANGELOG.md"
      - "Commit, tag, push"
      - "cargo publish (if releasing)"

  4_stop:
    rule: "MANDATORY stop - no 'just one more thing'"

# ═══════════════════════════════════════════════════════════════════════════════
# ANTI-PATTERNS
# ═══════════════════════════════════════════════════════════════════════════════
anti_patterns:
  scope_creep: "Note it for NEXT session, don't do it now"
  perfectionism: "Working code > Perfect code. Ship it."
  rabbit_holes: "Interesting? Note it. Back to milestone."
  over_engineering: "Build what's needed NOW, not hypothetical futures"

# ═══════════════════════════════════════════════════════════════════════════════
# AI AUTHORITY
# ═══════════════════════════════════════════════════════════════════════════════
authority:
  principle: "Make decisions. Don't ask. Ship."
  can_release_when:
    - "All tests pass"
    - "Zero warnings"
    - "Within milestone scope"
  ask_human_only:
    - "Blocked by external dependency"
    - "Fundamental requirement ambiguity"
