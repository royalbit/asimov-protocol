# Enterprise Template: api-spring
# Migrated from asimov-plus v2.1.0
# Java API with Spring Boot, JPA, OpenAPI, and Security

identity:
  name: "{PROJECT_NAME}"
  type: backend-api
  tagline: "Spring Boot API with Clean Architecture"

stack:
  framework: "Spring Boot 3.2 + JPA + OpenAPI + Security"
  language: "Java 21"
  database: "PostgreSQL"
  build_tool: "Maven"

quality:
  test: "./mvnw test"
  lint: "# Use IDE or Checkstyle"
  build: "./mvnw package -DskipTests"

structure:
  - src/main/java/com/{package}/Application.java
  - src/main/java/com/{package}/config/
  - src/main/java/com/{package}/controller/
  - src/main/java/com/{package}/entity/
  - src/main/java/com/{package}/repository/
  - src/main/java/com/{package}/service/
  - src/main/java/com/{package}/dto/
  - src/main/resources/application.yml
  - src/test/java/
  - pom.xml
  - Dockerfile
  - docker-compose.yml

features:
  - Spring Data JPA with PostgreSQL
  - SpringDoc OpenAPI (Swagger UI)
  - Spring Security configuration
  - Bean validation
  - Records for DTOs
  - MockMvc integration tests
  - Layered architecture
  - Docker support

# v10.8.0: Database migrations guidance (ADR-062)
migrations:
  principle: "Migration complete = functionally equivalent, not just compiles"
  tool: "Flyway or Liquibase"
  strategies:
    - test_parity: "Same tests pass before and after migration"
    - contract_testing: "Define input/output contracts, verify both satisfy"
    - behavioral_snapshots: "Capture old behavior as golden files"
    - shadow_mode: "Run both implementations, diff results"
  red_flags:
    - "Skipping tests for speed"
    - "Assuming compilation = correctness"
    - "Silent behavior changes"
